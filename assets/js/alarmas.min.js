var Alarma={};(function(){this.inicioIngreso=function(){$("#iTiposEmergencias").jCombo(siteUrl+"alarma/jsonTiposEmergencias"),$("#iComunas").jCombo(siteUrl+"session/obtenerJsonComunas",{handlerLoad:function(){$("#iComunas").picklist()},initial_text:null}),$("#fechaEmergencia, #fechaRecepcion").datetimepicker({format:"DD-MM-YYYY hh:mm"}),$("#frmIngresoAlarma").submit(this.irPaso2)},this.irPaso2=function(){var a=!1,e="";return $(".has-error").removeClass("has-error"),parseInt($("#iTiposEmergencias").val())||(e+="<span>",e+="<i class='fa fa-caret-right'></i>",e+="&nbsp;&nbsp;Debes especificar el tipo de emergencia<br/>",e+="</span>",$("#iTiposEmergencias").closest("div").addClass("has-error"),a=!0),a&&bootbox.dialog({title:"Error",message:e,buttons:{danger:{label:"Cerrar",className:"btn-danger"}}}),!a},this.inicioListado=function(){$("#iTiposEmergencias").jCombo(siteUrl+"alarma/jsonTiposEmergencias"),$("#iEstadoAlarma").jCombo(siteUrl+"alarma/jsonEstadosAlarmas"),$("#btnBuscarAlarmas").click(this.eventoBtnBuscar),$(window).resize(function(){$("table").css("width","100%")})},this.eventoBtnBuscar=function(){var a=siteUrl+"alarma/jsonAlarmasDT",e=$("#iAnio").val(),s=$("#iTiposEmergencias").val(),l=$("#iEstadoAlarma").val();parseInt(e)&&(a+="/anio/"+e),parseInt(s)&&(a+="/tipoEmergencia/"+s),parseInt(l)&&(a+="/estado/"+l);var i=$("#tblAlarmas").DataTable();i.destroy(),$("#tblAlarmas").empty(),$.get(a).done(function(a){var e=JSON.parse(a);e.columns[0].mRender=function(a,e,s){var l="";return l+='<div class="col-md-12 shadow" style="padding: 10px;">',l+='    <div class="col-md-1 text-center"><i class="fa fa-bell fa-4x"></i></div>',l+='    <div class="col-md-9">',l+='        <div class="form-group col-md-12">',l+='            <label for="" class="col-md-4 control-label">Fecha de la emergencia:</label>',l+='            <div class="col-md-8">',l+="                <p>"+s.ala_d_fecha_emergencia+"</p>",l+="            </div>",l+="        </div>",l+='        <div class="form-group col-md-12">',l+='            <label for="" class="col-md-4 control-label">Nombre de la emergencia:</label>',l+='            <div class="col-md-8">',l+="                <p>"+s.ala_c_nombre_emergencia+"</p>",l+="            </div>",l+="        </div>",l+='        <div class="form-group col-md-12">',l+='            <label for="" class="col-md-4 control-label">Tipo de la emergencia:</label>',l+='            <div class="col-md-8">',l+="                <p>"+s.ala_c_tipo_emergencia+"</p>",l+="            </div>",l+="        </div>",l+='        <div class="form-group col-md-12">',l+='            <label for="" class="col-md-4 control-label">Lugar de la emergencia:</label>',l+='            <div class="col-md-8">',l+="                <p>"+s.ala_c_lugar_emergencia+"</p>",l+="            </div>",l+="        </div>",l+="    </div>",l+='    <div class="col-md-2 text-center">',l+='       <div class="btn-group">',l+='           <a title="Generar emergencia" class="btn btn-default">',l+='               <i class="fa fa-exclamation-triangle"></i>',l+="            </a>",l+='           <a title="Editar" class="btn btn-default">',l+='               <i class="fa fa-pencil"></i>',l+="           </a>",l+='           <a title="Eliminar" class="btn btn-default">',l+='               <i class="fa fa-trash"></i>',l+="           </a>",l+="       </div>",l+="    </div>",l+="</div>"},$("#tblAlarmas").DataTable({data:e.data,columns:e.columns,language:{url:baseUrl+"assets/lib/DataTables-1.10.8/Spanish.json"},order:[[0,"desc"]]}),$("#pResultados").css("visibility","visible"),$("#pResultados").slideDown("slow")})}}).apply(Alarma);