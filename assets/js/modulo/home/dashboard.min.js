function formEditarAlarma(e){limpiaVista(),content=$("#contenedor-home").html(),$("#contenedor-home").fadeOut(function(){$(this).html('<div class="text-center"><i class="fa fa-spin fa-spinner fa-5x"></i></div>').fadeIn(function(){$(this).load(siteUrl+"alarma/editar/id/"+e)})})}function formEditarEmergencia(e){limpiaVista(),content=$("#contenedor-home").html(),$("#contenedor-home").fadeOut(function(){$(this).html('<div class="text-center"><i class="fa fa-spin fa-spinner fa-5x"></i></div>').fadeIn(function(){$(this).load(siteUrl+"emergencia/editar/id/"+e)})})}function setGraficoEmergenciasTipo(){$.ajax({dataType:"json",cache:!1,async:!0,data:"",type:"post",url:siteUrl+"home/json_cantidad_emergencia_por_tipo",error:function(e,a,t){},success:function(e){if(e.correcto){var a=e.data;$.plot($("#flot-chart-pie"),a,{series:{pie:{show:!0}},grid:{hoverable:!0},tooltip:!0,tooltipOpts:{content:"%p.0%, %s",shifts:{x:20,y:0},defaultTheme:!1}})}}})}function setGraficoEmergenciasMes(){$.ajax({dataType:"json",cache:!1,async:!0,data:"",type:"post",url:siteUrl+"home/json_cantidad_emergencia_mes",error:function(e,a,t){},success:function(e){if(e.correcto){var a=["En","Feb","Mar","Abr","May","Jun","Jul","Ago","Sep","Oct","Nov","Dic"];Morris.Line({element:"morris-chart-line",data:e.data,xkey:"m",hideHover:!0,ykeys:e.ykeys,labels:e.labels,xLabelFormat:function(e){return a[e.getMonth()]},smooth:!1,resize:!1})}}})}function load(){setCalendario(),setGraficoEmergenciasMes(),setGraficoEmergenciasTipo(),reloadGrillas()}function reloadGrillas(){reloadGrillaEmergencias(),reloadGrillaAlarmas()}function reloadGrillaAlarmas(){var e={desde:$("#fecha_desde").val(),hasta:$("#fecha_hasta").val()};$.ajax({dataType:"html",cache:!1,async:!0,data:e,type:"post",url:siteUrl+"home/ajax_grilla_alarmas",error:function(e,a,t){},success:function(e){$("#contendor-grilla-alarma").html(e)}})}function reloadGrillaEmergencias(){var e={desde:$("#fecha_desde").val(),hasta:$("#fecha_hasta").val()};$.ajax({dataType:"html",cache:!1,async:!0,data:e,type:"post",url:siteUrl+"home/ajax_grilla_emergencias",error:function(e,a,t){},success:function(e){$("#contendor-grilla-emergencia").html(e)}})}function setCalendario(){var e=new Date;e.getDate(),e.getMonth(),e.getFullYear();$("#calendar").fullCalendar({header:{left:"prev,next today",center:"title",right:"month,agendaWeek,agendaDay"},lang:"es",editable:!1,droppable:!1,eventSources:[{url:siteUrl+"home/json_eventos_calendario_alertas",type:"POST",error:function(){alert("Ha ocurrido un error al cargar las alarmas al calendario!")},color:"orange",textColor:"black"},{url:siteUrl+"home/json_eventos_calendario_emergencias",type:"POST",error:function(){alert("Ha ocurrido un error al cargar las emergencias al calendario!")},color:"red",textColor:"white"}]})}function limpiaVista(){$("#calendar").html(""),$("#morris-chart-line").html(""),$("#contendor-grilla-alarma").html(""),$("#contendor-grilla-emergencia").html("")}var content;$(document).ready(function(){load(),$("#btnCancelar").livequery(function(){$(this).click(function(){$("#contenedor-home").fadeOut(function(){$(this).html('<div class="text-center"><i class="fa fa-spin fa-spinner fa-5x"></i></div>').fadeIn(function(){$(this).html(content),load()})})})})});